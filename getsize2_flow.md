graph TD
    A[开始执行GETSIZE2宏] --> B{检查是否可以执行ProductDocument}
    B -->|否| C[退出宏]
    B -->|是| D[提示用户选择产品]
    D --> E[用户选择产品]
    E --> F{产品是否选择成功}
    F -->|否| C
    F -->|是| G[获取产品中的实体Body]
    G --> H{是否成功获取Body}
    H -->|否| C
    H -->|是| I[创建新的Part文档]
    I --> J[获取或创建坐标系]
    J --> K[计算所有Body的包围盒尺寸]
    K --> L[创建名为MinimumBox的新实体]
    L --> M[修改实体颜色和样式]
    M --> N{是否存在坐标系}
    N -->|否| O[使用XY基准平面作为草图平面]
    N -->|是| P[获取坐标系的基准平面]
    P --> Q[基于选择的平面创建草图]
    Q --> R[在草图中创建包围盒的2D轮廓]
    R --> S[基于草图创建拉伸体]
    S --> T[更新Part文档]
    T --> U[显示完成消息]
    U --> V[宏执行结束]

    K --> K1[计算6个方向的最大距离]
    K1 --> K2[遍历每个Body]
    K2 --> K3[对每个方向计算最小距离]
    K3 --> K4[更新包围盒边界值]
    K4 --> K2
    K2 --> K5[完成所有Body的计算]

    R --> R1[创建四个角点]
    R1 --> R2[连接四条边]
    R2 --> R3{检查边是否垂直或水平}
    R3 -->|是| R4[添加垂直/水平约束]
    R3 -->|否| R5[仅创建几何线]
    R4 --> R6[添加距离约束]
    R5 --> R7[完成2D轮廓创建]
    R6 --> R7

    subgraph 计算包围盒
        K1
        K2
        K3
        K4
        K5
    end

    subgraph 创建2D轮廓
        R1
        R2
        R3
        R4
        R5
        R6
        R7
    end
